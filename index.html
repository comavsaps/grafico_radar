<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Radar de Equipe por Setores</title>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Plugin para rÃ³tulos radiais -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>

    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            background: #f4f7f9;
        }

        .container {
            background: #ffffff;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
            width: 95%;
            max-width: 780px;
            text-align: center;
        }

        .instrucoes {
            background: #eaf2f8;
            color: #2f4f66;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 14px;
            border: 1px solid #d6e3ee;
        }

        .canvas-container {
            position: relative;
            height: 520px;
            margin: 20px 0;
        }

        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
        }

        button {
            padding: 12px 25px;
            cursor: pointer;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: bold;
            transition: 0.2s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .btn-save {
            background: #4180AB;
            color: white;
        }

        .btn-save:hover {
            background: #356a8f;
            transform: translateY(-1px);
        }

        .btn-reset {
            background: #6c757d;
            color: white;
        }

        .btn-reset:hover {
            background: #5a6268;
        }

        h2 {
            margin-bottom: 5px;
            color: #2f4f66;
        }

        p.subtitle {
            color: #6b7c8f;
            margin-top: 0;
            margin-bottom: 25px;
        }
    </style>
</head>

<body>

<div class="container">
    <h2>Radar de Funcionamento da Equipe</h2>
    <p class="subtitle">CoordenaÃ§Ã£o de Monitoramento e AvaliaÃ§Ã£o</p>

    <div class="instrucoes">
        <strong>Interatividade:</strong> clique em qualquer ponto da fatia para definir a nota (0 a 10).
    </div>

    <div class="canvas-container">
        <canvas id="polarChart"></canvas>
    </div>

    <div class="controls">
        <button class="btn-save" onclick="baixarImagem()">ðŸ“¥ Salvar para ApresentaÃ§Ã£o</button>
        <button class="btn-reset" onclick="resetar()">ðŸ”„ Limpar Tudo</button>
    </div>
</div>

<script>
    const ctx = document.getElementById('polarChart').getContext('2d');

    const labels = [
        "ComunicaÃ§Ã£o interna",
        "Fluxo de trabalho",
        "GestÃ£o de prazos",
        "Autonomia e clareza",
        "IntegraÃ§Ã£o e equipe",
        "Bem-estar / Sustentabilidade",
        "ArticulaÃ§Ã£o institucional",
        "Capacidade analÃ­tica"
    ];

const cores = [
    'rgb(212, 106, 92)',   // Coral Profundo
    'rgb(239, 135, 121)',  // Tom 1 (Original #EF8779)
    'rgb(255, 149, 133)',  // SalmÃ£o Vibrante
    'rgb(243, 165, 155)',  // Tom 2 (Original #F3A59B)
    'rgb(247, 195, 188)',  // Tom 3 (Original #F7C3BC)
    'rgb(250, 209, 201)',  // PÃªssego Suave
    'rgb(252, 224, 217)',  // Nude Rosado
    'rgb(255, 241, 237)'   // Branco Coralino
];

    let dados = JSON.parse(localStorage.getItem('polarData')) || Array(8).fill(0);

    const chart = new Chart(ctx, {
        type: 'polarArea',
        data: {
            labels: labels,
            datasets: [{
                data: dados,
                backgroundColor: cores,
                borderColor: '#ffffff',
                borderWidth: 3,
                borderAlign: 'inner'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                r: {
                    min: 0,
                    max: 10,
                    ticks: {
                        stepSize: 1,
                        color: '#6b7c8f',
                        backdropColor: 'transparent'
                    },
                    grid: {
                        color: '#dde5ec',
                        lineWidth: 1
                    }
                }
            },
            plugins: {
                legend: {
                    display: false
                },
                datalabels: {
                    color: '#2f4f66',
                    font: {
                        size: 11,
                        weight: '500'
                    },
                    formatter: (value, context) => {
                        if (value === 0) return '';
                        return `${context.chart.data.labels[context.dataIndex]} (${value})`;
                    },
                    anchor: 'end',
                    align: 'end',
                    offset: 10,
                    clamp: true
                }
            },
            onClick: (e) => {
                const pos = Chart.helpers.getRelativePosition(e, chart);

                const dx = pos.x - chart.scales.r.xCenter;
                const dy = pos.y - chart.scales.r.yCenter;
                const distance = Math.sqrt(dx * dx + dy * dy);
                const maxRadius = chart.scales.r.drawingArea;

                let nota = Math.round((distance / maxRadius) * 10);
                nota = Math.min(Math.max(nota, 0), 10);

                let angle = Math.atan2(dy, dx) + Math.PI / 2;
                if (angle < 0) angle += Math.PI * 2;

                const index = Math.floor((angle / (Math.PI * 2)) * labels.length) % labels.length;

                chart.data.datasets[0].data[index] = nota;
                chart.update();

                localStorage.setItem('polarData', JSON.stringify(chart.data.datasets[0].data));
            }
        },
        plugins: [ChartDataLabels]
    });

    function baixarImagem() {
        const tempCanvas = document.createElement('canvas');
        tempCanvas.width = chart.width;
        tempCanvas.height = chart.height;

        const tempCtx = tempCanvas.getContext('2d');
        tempCtx.fillStyle = "#ffffff";
        tempCtx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);
        tempCtx.drawImage(chart.canvas, 0, 0);

        const link = document.createElement('a');
        link.download = 'radar_funcionamento_equipe.png';
        link.href = tempCanvas.toDataURL('image/png');
        link.click();
    }

    function resetar() {
        if (confirm("Deseja limpar todas as notas?")) {
            chart.data.datasets[0].data = Array(8).fill(0);
            chart.update();
            localStorage.removeItem('polarData');
        }
    }
</script>

</body>
</html>
